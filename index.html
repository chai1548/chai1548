<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shipping Records - Column Headers</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 100%;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 20px;
        }
        .header-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .header-table th, .header-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .header-table th {
            background-color: #4CAF50;
            color: white;
        }
        .header-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .loading {
            text-align: center;
            padding: 20px;
        }
        .error {
            color: red;
            text-align: center;
            padding: 20px;
        }
        .highlight {
            background-color: #fffacd;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Shipping Records Column Headers</h1>
        <div id="loading" class="loading">Loading data...</div>
        <div id="error" class="error" style="display: none;"></div>
        <div id="headerContainer" style="display: none;">
            <h3>Column Headers from Row 3:</h3>
            <table class="header-table">
                <thead>
                    <tr>
                        <th>No.</th>
                        <th>Header Name</th>
                        <th>Example Value</th>
                    </tr>
                </thead>
                <tbody id="headersTable">
                    <!-- Headers will be inserted here -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const apiUrl = 'https://opensheet.elk.sh/19SPIZrH3EdkPLv3zYHtZVvmnhU-NcHCYUiIpDK3ON4s/10';
            const loadingElement = document.getElementById('loading');
            const errorElement = document.getElementById('error');
            const headerContainer = document.getElementById('headerContainer');
            const headersTable = document.getElementById('headersTable');

            // These are the headers you specified from row 3
            const specifiedHeaders = [
                "No.",
                "Date",
                "Code ",
                "Account Name",
                "Phone No.",
                "Location.from",
                "Unit",
                "Item",
                "Receiver's Name",
                "Phone No.",
                "Location.to",
                "KG",
                "Price (Baht)",
                "TOTAL",
                "Remark",
                "Checked",
                "Remark",
                "Checked",
                "Remark",
                "Checked",
                "Remark",
                "Checked",
                "Remark"
            ];

            fetch(apiUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    loadingElement.style.display = 'none';
                    
                    if (data.length < 4) {
                        errorElement.textContent = 'Not enough rows in data';
                        errorElement.style.display = 'block';
                        return;
                    }

                    // Display each specified header with an example value from row 4
                    specifiedHeaders.forEach((header, index) => {
                        const row = document.createElement('tr');
                        
                        // Get example value from row 4 (index 3)
                        let exampleValue = '';
                        if (data[3][header] !== undefined) {
                            exampleValue = data[3][header];
                        }
                        
                        // Highlight the Phone No. and Checked columns
                        const isHighlight = header === "Phone No." || header === "Checked";
                        
                        row.innerHTML = `
                            <td>${index + 1}</td>
                            <td class="${isHighlight ? 'highlight' : ''}">${header}</td>
                            <td>${exampleValue || 'N/A'}</td>
                        `;
                        headersTable.appendChild(row);
                    });

                    headerContainer.style.display = 'block';
                })
                .catch(error => {
                    loadingElement.style.display = 'none';
                    errorElement.textContent = 'Error loading data: ' + error.message;
                    errorElement.style.display = 'block';
                    console.error('Error:', error);
                });
        });
    </script>
</body>
</html>
